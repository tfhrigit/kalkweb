<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculator</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {}
            }
        }
    </script>
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Lucide icons as components
        const Moon = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/>
            </svg>
        );

        const Sun = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <circle cx="12" cy="12" r="4"/>
                <path d="M12 2v2"/>
                <path d="M12 20v2"/>
                <path d="M4.93 4.93l1.41 1.41"/>
                <path d="M17.66 17.66l1.41 1.41"/>
                <path d="M2 12h2"/>
                <path d="M20 12h2"/>
                <path d="M6.34 17.66l-1.41 1.41"/>
                <path d="M19.07 4.93l-1.41 1.41"/>
            </svg>
        );

        const RotateCcw = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
                <path d="M3 3v5h5"/>
            </svg>
        );

        const Calculator = () => {
            const [display, setDisplay] = useState('0');
            const [previousValue, setPreviousValue] = useState(null);
            const [operation, setOperation] = useState(null);
            const [waitingForOperand, setWaitingForOperand] = useState(false);
            const [history, setHistory] = useState([]);
            const [isDark, setIsDark] = useState(false);

            const inputDigit = (digit) => {
                if (waitingForOperand) {
                    setDisplay(String(digit));
                    setWaitingForOperand(false);
                } else {
                    setDisplay(display === '0' ? String(digit) : display + digit);
                }
            };

            const inputDecimal = () => {
                if (waitingForOperand) {
                    setDisplay('0.');
                    setWaitingForOperand(false);
                } else if (display.indexOf('.') === -1) {
                    setDisplay(display + '.');
                }
            };

            const clear = () => {
                setDisplay('0');
                setPreviousValue(null);
                setOperation(null);
                setWaitingForOperand(false);
            };

            const toggleSign = () => {
                if (display !== '0') {
                    setDisplay(display.charAt(0) === '-' ? display.slice(1) : '-' + display);
                }
            };

            const percentage = () => {
                const value = parseFloat(display);
                setDisplay(String(value / 100));
            };

            const performOperation = (nextOperation) => {
                const inputValue = parseFloat(display);
                
                if (previousValue === null) {
                    setPreviousValue(inputValue);
                } else if (operation) {
                    const currentValue = previousValue || 0;
                    const newValue = calculate(currentValue, inputValue, operation);
                    
                    const historyEntry = `${currentValue} ${getOperationSymbol(operation)} ${inputValue} = ${newValue}`;
                    setHistory(prev => [historyEntry, ...prev.slice(0, 9)]);
                    
                    setDisplay(String(newValue));
                    setPreviousValue(newValue);
                }
                
                setWaitingForOperand(true);
                setOperation(nextOperation);
            };

            const calculate = (firstValue, secondValue, operation) => {
                switch (operation) {
                    case 'add':
                        return firstValue + secondValue;
                    case 'subtract':
                        return firstValue - secondValue;
                    case 'multiply':
                        return firstValue * secondValue;
                    case 'divide':
                        return secondValue !== 0 ? firstValue / secondValue : 0;
                    default:
                        return secondValue;
                }
            };

            const getOperationSymbol = (op) => {
                switch (op) {
                    case 'add': return '+';
                    case 'subtract': return '-';
                    case 'multiply': return '×';
                    case 'divide': return '÷';
                    default: return '';
                }
            };

            // Keyboard support
            useEffect(() => {
                const handleKeyPress = (e) => {
                    const { key } = e;
                    
                    if (/\d/.test(key)) {
                        inputDigit(parseInt(key));
                    } else if (key === '.') {
                        inputDecimal();
                    } else if (key === '+') {
                        performOperation('add');
                    } else if (key === '-') {
                        performOperation('subtract');
                    } else if (key === '*') {
                        performOperation('multiply');
                    } else if (key === '/') {
                        e.preventDefault();
                        performOperation('divide');
                    } else if (key === 'Enter' || key === '=') {
                        performOperation(null);
                    } else if (key === 'Escape' || key === 'c' || key === 'C') {
                        clear();
                    } else if (key === '%') {
                        percentage();
                    }
                };

                window.addEventListener('keydown', handleKeyPress);
                return () => window.removeEventListener('keydown', handleKeyPress);
            }, [display, operation, previousValue, waitingForOperand]);

            const Button = ({ className = '', children, onClick, ...props }) => (
                React.createElement('button', {
                    className: `
                        w-full h-16 rounded-2xl font-bold text-lg
                        transition-all duration-200 ease-out
                        transform active:scale-95 hover:scale-105
                        shadow-lg hover:shadow-xl
                        ${className}
                    `,
                    onClick: onClick,
                    ...props
                }, children)
            );

            return React.createElement('div', {
                className: `min-h-screen transition-all duration-500 ${
                    isDark 
                        ? 'bg-gradient-to-br from-gray-900 via-purple-900 to-violet-900' 
                        : 'bg-gradient-to-br from-blue-400 via-purple-500 to-pink-500'
                }`
            },
                React.createElement('div', { className: "container mx-auto px-4 py-8 max-w-md" },
                    // Header
                    React.createElement('div', { className: "flex justify-between items-center mb-6" },
                        React.createElement('h1', {
                            className: `text-2xl font-bold ${isDark ? 'text-white' : 'text-white'}`
                        }, ''),
                        React.createElement('button', {
                            onClick: () => setIsDark(!isDark),
                            className: `p-3 rounded-full transition-all duration-300 ${
                                isDark 
                                    ? 'bg-yellow-400 text-gray-900 hover:bg-yellow-300' 
                                    : 'bg-gray-800 text-yellow-400 hover:bg-gray-700'
                            }`
                        }, isDark ? React.createElement(Sun, { size: 20 }) : React.createElement(Moon, { size: 20 }))
                    ),

                    // History
                    history.length > 0 && React.createElement('div', {
                        className: `mb-4 p-4 rounded-2xl max-h-32 overflow-y-auto ${
                            isDark ? 'bg-black/20 backdrop-blur-sm' : 'bg-white/20 backdrop-blur-sm'
                        }`
                    },
                        React.createElement('div', { className: "flex justify-between items-center mb-2" },
                            React.createElement('span', {
                                className: `text-sm font-medium ${isDark ? 'text-gray-300' : 'text-white/80'}`
                            }, 'History'),
                            React.createElement('button', {
                                onClick: () => setHistory([]),
                                className: `p-1 rounded-full transition-colors ${
                                    isDark ? 'hover:bg-white/10' : 'hover:bg-black/10'
                                }`
                            }, React.createElement(RotateCcw, {
                                size: 14,
                                className: isDark ? 'text-gray-400' : 'text-white/70'
                            }))
                        ),
                        React.createElement('div', { className: "space-y-1" },
                            history.map((entry, index) =>
                                React.createElement('div', {
                                    key: index,
                                    className: `text-sm font-mono ${isDark ? 'text-gray-400' : 'text-white/70'}`
                                }, entry)
                            )
                        )
                    ),

                    // Calculator Body
                    React.createElement('div', {
                        className: `rounded-3xl p-6 shadow-2xl backdrop-blur-sm ${
                            isDark ? 'bg-black/30' : 'bg-white/25'
                        }`
                    },
                        // Display
                        React.createElement('div', {
                            className: `mb-6 p-6 rounded-2xl text-right ${
                                isDark ? 'bg-gray-900/50' : 'bg-black/20'
                            }`
                        },
                            React.createElement('div', {
                                className: `text-4xl font-mono font-bold break-all ${
                                    isDark ? 'text-white' : 'text-white'
                                }`
                            }, display)
                        ),

                        // Buttons Grid
                        React.createElement('div', { className: "grid grid-cols-4 gap-3" },
                            // Row 1
                            React.createElement(Button, {
                                className: `col-span-2 ${
                                    isDark 
                                        ? 'bg-red-600 hover:bg-red-500 text-white' 
                                        : 'bg-red-500 hover:bg-red-400 text-white'
                                }`,
                                onClick: clear
                            }, 'Clear'),
                            React.createElement(Button, {
                                className: `${
                                    isDark 
                                        ? 'bg-orange-600 hover:bg-orange-500 text-white' 
                                        : 'bg-orange-500 hover:bg-orange-400 text-white'
                                }`,
                                onClick: toggleSign
                            }, '±'),
                            React.createElement(Button, {
                                className: `${
                                    isDark 
                                        ? 'bg-orange-600 hover:bg-orange-500 text-white' 
                                        : 'bg-orange-500 hover:bg-orange-400 text-white'
                                }`,
                                onClick: percentage
                            }, '%'),

                            // Row 2
                            React.createElement(Button, {
                                className: `${
                                    isDark 
                                        ? 'bg-gray-700 hover:bg-gray-600 text-white' 
                                        : 'bg-gray-600 hover:bg-gray-500 text-white'
                                }`,
                                onClick: () => inputDigit(7)
                            }, '7'),
                            React.createElement(Button, {
                                className: `${
                                    isDark 
                                        ? 'bg-gray-700 hover:bg-gray-600 text-white' 
                                        : 'bg-gray-600 hover:bg-gray-500 text-white'
                                }`,
                                onClick: () => inputDigit(8)
                            }, '8'),
                            React.createElement(Button, {
                                className: `${
                                    isDark 
                                        ? 'bg-gray-700 hover:bg-gray-600 text-white' 
                                        : 'bg-gray-600 hover:bg-gray-500 text-white'
                                }`,
                                onClick: () => inputDigit(9)
                            }, '9'),
                            React.createElement(Button, {
                                className: `${
                                    isDark 
                                        ? 'bg-blue-600 hover:bg-blue-500 text-white' 
                                        : 'bg-blue-500 hover:bg-blue-400 text-white'
                                }`,
                                onClick: () => performOperation('divide')
                            }, '÷'),

                            // Row 3
                            React.createElement(Button, {
                                className: `${
                                    isDark 
                                        ? 'bg-gray-700 hover:bg-gray-600 text-white' 
                                        : 'bg-gray-600 hover:bg-gray-500 text-white'
                                }`,
                                onClick: () => inputDigit(4)
                            }, '4'),
                            React.createElement(Button, {
                                className: `${
                                    isDark 
                                        ? 'bg-gray-700 hover:bg-gray-600 text-white' 
                                        : 'bg-gray-600 hover:bg-gray-500 text-white'
                                }`,
                                onClick: () => inputDigit(5)
                            }, '5'),
                            React.createElement(Button, {
                                className: `${
                                    isDark 
                                        ? 'bg-gray-700 hover:bg-gray-600 text-white' 
                                        : 'bg-gray-600 hover:bg-gray-500 text-white'
                                }`,
                                onClick: () => inputDigit(6)
                            }, '6'),
                            React.createElement(Button, {
                                className: `${
                                    isDark 
                                        ? 'bg-blue-600 hover:bg-blue-500 text-white' 
                                        : 'bg-blue-500 hover:bg-blue-400 text-white'
                                }`,
                                onClick: () => performOperation('multiply')
                            }, '×'),

                            // Row 4
                            React.createElement(Button, {
                                className: `${
                                    isDark 
                                        ? 'bg-gray-700 hover:bg-gray-600 text-white' 
                                        : 'bg-gray-600 hover:bg-gray-500 text-white'
                                }`,
                                onClick: () => inputDigit(1)
                            }, '1'),
                            React.createElement(Button, {
                                className: `${
                                    isDark 
                                        ? 'bg-gray-700 hover:bg-gray-600 text-white' 
                                        : 'bg-gray-600 hover:bg-gray-500 text-white'
                                }`,
                                onClick: () => inputDigit(2)
                            }, '2'),
                            React.createElement(Button, {
                                className: `${
                                    isDark 
                                        ? 'bg-gray-700 hover:bg-gray-600 text-white' 
                                        : 'bg-gray-600 hover:bg-gray-500 text-white'
                                }`,
                                onClick: () => inputDigit(3)
                            }, '3'),
                            React.createElement(Button, {
                                className: `${
                                    isDark 
                                        ? 'bg-blue-600 hover:bg-blue-500 text-white' 
                                        : 'bg-blue-500 hover:bg-blue-400 text-white'
                                }`,
                                onClick: () => performOperation('subtract')
                            }, '-'),

                            // Row 5
                            React.createElement(Button, {
                                className: `col-span-2 ${
                                    isDark 
                                        ? 'bg-gray-700 hover:bg-gray-600 text-white' 
                                        : 'bg-gray-600 hover:bg-gray-500 text-white'
                                }`,
                                onClick: () => inputDigit(0)
                            }, '0'),
                            React.createElement(Button, {
                                className: `${
                                    isDark 
                                        ? 'bg-gray-700 hover:bg-gray-600 text-white' 
                                        : 'bg-gray-600 hover:bg-gray-500 text-white'
                                }`,
                                onClick: inputDecimal
                            }, '.'),
                            React.createElement(Button, {
                                className: `${
                                    isDark 
                                        ? 'bg-blue-600 hover:bg-blue-500 text-white' 
                                        : 'bg-blue-500 hover:bg-blue-400 text-white'
                                }`,
                                onClick: () => performOperation('add')
                            }, '+'),

                            // Equals Button
                            React.createElement(Button, {
                                className: `col-span-4 mt-3 ${
                                    isDark 
                                        ? 'bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-500 hover:to-emerald-500 text-white' 
                                        : 'bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-400 hover:to-emerald-400 text-white'
                                }`,
                                onClick: () => performOperation(null)
                            }, '=')
                        )
                    ),

                    // Footer
                    React.createElement('div', { className: "mt-6 text-center" },
                        React.createElement('p', {
                            className: `text-sm ${isDark ? 'text-white/60' : 'text-white/80'}`
                        }, 'Use keyboard for quick input • ESC to clear')
                    )
                )
            );
        };

        ReactDOM.render(React.createElement(Calculator), document.getElementById('root'));
    </script>
</body>
</html>